%% pcon_ifix
pcon_ifix = [0.09263
0.05354
0.15907
0
0
0.02652
0.18713
0.05749
0
0
0.02757
0.06036
0.24283
0.00112
0
0.05249
0.02253
0.02279
0.02354
0.0045
0.03723
0.03549
0.04656
0.01985
0.0041
0.0023
0.0164
0.01887
0.02843
0.00608
0
0.00248
0.02445
0.02534
0.01239
0
0
0
0.0282
0.01523
0
0
0
0.02209
0.0282

0.01552
0.00752
0.00313
0.00161
0.00162
0.00566
0.00283
0
0.01825
0.02673
0.01177
0.00447
0.01216
0.01007
0.00672
0
0.0199
0.25242
0.10856
0.01429
0.0429
0.0403
0.01982
0
0.02528
0.07305
0.03289
0.01182
0.01017
0.00814
0.00615
0
0.03508
0.02558
0.0212
0.01126
0.01244
0.01172
0.00771
0
0.24283
0.02792
0.02731
0.01384
0.01409
0.02068
0.01678
0
0.01015
0.27108
0.02483
0.01865
0.01966
0.02269
0
0
0
0.0367
0.19058
0.01417
0.01148
0.00896
0.01049
0
0.00516
0.06083
0.05276
0.07207
0.01464
0.02666
0.0189
0
0.02669
0.05569
0.04304
0.01716
0.07207
0.02512
0.03215
0
0.012
0.05577
0.04895
0.02604
0.02285
0.07207
0.03437
0
0.01128
0.03357
0.05406
0.03109
0.02212
0.03198
0.07207
0
0.02865
0.03087
0.02845
0.02626
0.03999
0.03449
0.03762
0.06514
0
0.10538
0.05033
0.0371
0.04348
0.07874
0.02447
0
0
0.03777
0.03426
0.00944
0.01732
0.03038
0.03983
0
0
0.01306
0.0208
0.00606
0.01059
0.01826
0.02623
0

0.00007
0.00152
0.00175
0.00834
0.00121
0.0151
0.00834
0.03265
0.0344
0.05135
0.02531
0
0.15193
0.19617
0.32257
0.11603
0.04989
0.03963
0.11919
0.12195
0.06862
0.01836
0.01323
0
0.06539
0.06917
0.03868
0.00778
0.00557
0.00954
0.03477
0.03161
0.01466
0.00559
0.00364
0.0032
0.012
0.02515
0.01581
0.0112
0.00632
0.00845
0.19058
0.01695
0.02083
0.01875
0.01068
0.02621
0.06517
0.07207
0.02806
0.02714
0.02555
0.04785
0.06122
0.02694
0.07207
0.04268
0.03144
0.06465
0.05847
0.03243
0.02506
0.07207
0.04815
0.05065
0.11183
0.04361
0.03592
0.03573
0.07207
0.03327
0.0287
0.03114
0.04704
0.064
0.04217
0.10083
0.0842
0.02139
0.04168
0.0791
0.05949
0.06274
0.01194
0.01487
0.01159
0.01603
0.02624
0.02597
0.03389
0.00614
0.0087
0.01269
0.0154
0.01161

0.18713
0.21712
0
0.02222
0.03494
0.01553
0
0.02485
0.02343

0.18713
0.01996
0
0.02222
0.19058
0.01553
0
0.02485
0.02343];

%% icon_ifix
icon_ifix = [0.64
0.44
0.31
0
0
0.71
0.78
0.36
0
0
0.98
0.58
0.95
2.27
2.27
0.52
0.67
0.48
0.28
0.28
0.21
0.26
0.17
0.49
0.49
0.21
0.26
0.17
0.49
0.49
0.21
0.26
0.17
0.49
0.49
0
0
0
0.53
0.53
0
0
0
0.53
0.53

0.31
0.43
0.55
0.55
0.22
0.22
0.22
0.11
0.31
0.43
0.55
0.55
0.22
0.22
0.22
0.11
0.31
0.43
0.55
0.55
0.22
0.22
0.22
0.11
0.36
0.645
0.93
1.01
1.01
1.01
1.01
0.505
0.36
0.645
0.93
1.01
1.01
1.01
1.01
0.505
0.95
0.745
0.54
0.88
0.88
0.88
0.88
1.575
0.715
0.6575
0.6
0.88
0.88
0.88
0.88
1.0775
0.48
0.57
0.66
0.88
0.88
0.88
0.88
0.58
0.17
0.205
0.24
0.71
0.71
0.71
0.71
0.6
0.17
0.205
0.24
0.71
0.71
0.71
0.71
0.6
0.17
0.205
0.24
0.71
0.71
0.71
0.71
0.6
0.17
0.205
0.24
0.71
0.71
0.71
0.71
0.6
0.085
0.1225
0.16
0.505
0.505
0.505
0.505
0.5075
0
0.04
0.08
0.3
0.3
0.3
0.3
0.415
0
0.04
0.08
0.3
0.3
0.3
0.3
0.415
0
0.04
0.08
0.3
0.3
0.3
0.3
0.415

0.55
0.55
0.22
0.22
0.22
0.11
0.55
0.55
0.22
0.22
0.22
0.11
0.55
0.55
0.22
0.22
0.22
0.11
0.93
1.01
1.01
1.01
1.01
0.505
0.93
1.01
1.01
1.01
1.01
0.505
0.54
0.88
0.88
0.88
0.88
1.575
0.6
0.88
0.88
0.88
0.88
1.0775
0.66
0.88
0.88
0.88
0.88
0.58
0.24
0.71
0.71
0.71
0.71
0.6
0.24
0.71
0.71
0.71
0.71
0.6
0.24
0.71
0.71
0.71
0.71
0.6
0.24
0.71
0.71
0.71
0.71
0.6
0.16
0.505
0.505
0.505
0.505
0.5075
0.08
0.3
0.3
0.3
0.3
0.415
0.08
0.3
0.3
0.3
0.3
0.415
0.08
0.3
0.3
0.3
0.3
0.415

0.78
1.01
0
0.3525
0.1225
0.4375
0
0.24786
0.53

0.78
0.11
0
0.3625
1.0775
0.4375
0
0.24786
0.53];

%% pcon_pfix
pcon_pfix = [
    0.092631579
0.054644809
0.009615385
0
0
0.120879121
0.187134503
0.023529412
0
0
0.120192308
0.145348837
0.242829828
0.032258065
0.032258065
0.043062201
0.02247191
0.007272727
0.03164557
0.03164557
0.009615385
0.017964072
0.00729927
0.07
0.07
0.009615385
0.017964072
0.00729927
0.07
0.07
0.009615385
0.017964072
0.00729927
0.07
0.07
0
0
0
0.028195489
0.028195489
0
0
0
0.028195489
0.028195489

0.009615385
0.052201057
0.09478673
0.09478673
0.083333333
0.083333333
0.083333333
0.041666667
0.009615385
0.052201057
0.09478673
0.09478673
0.083333333
0.083333333
0.083333333
0.041666667
0.009615385
0.052201057
0.09478673
0.09478673
0.083333333
0.083333333
0.083333333
0.041666667
0.023529412
0.040500338
0.057471264
0.12195122
0.12195122
0.12195122
0.12195122
0.06097561
0.023529412
0.040500338
0.057471264
0.12195122
0.12195122
0.12195122
0.12195122
0.06097561
0.242829828
0.179385928
0.115942029
0.080882353
0.080882353
0.080882353
0.080882353
0.056570209
0.125051278
0.139155686
0.082502892
0.063238606
0.063238606
0.063238606
0.063238606
0.056196497
0.007272727
0.098925443
0.190578158
0.08
0.08
0.08
0.08
0.055822785
0.00729927
0.012270325
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.00729927
0.012270325
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.00729927
0.012270325
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.00729927
0.012270325
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.085
0.1225
0.01174569
0.046036036
0.046036036
0.046036036
0.046036036
0.04756689
0
0.003125
0.00625
0.02
0.02
0.02
0.02
0.024097744
0
0.003125
0.00625
0.02
0.02
0.02
0.02
0.024097744
0
0.003125
0.00625
0.02
0.02
0.02
0.02
0.024097744

0.09478673
0.09478673
0.083333333
0.083333333
0.083333333
0.041666667
0.09478673
0.09478673
0.083333333
0.083333333
0.083333333
0.041666667
0.09478673
0.09478673
0.083333333
0.083333333
0.083333333
0.041666667
0.057471264
0.12195122
0.12195122
0.12195122
0.12195122
0.06097561
0.057471264
0.12195122
0.12195122
0.12195122
0.12195122
0.06097561
0.115942029
0.080882353
0.080882353
0.080882353
0.080882353
0.056570209
0.082502892
0.063238606
0.063238606
0.063238606
0.063238606
0.056196497
0.190578158
0.08
0.08
0.08
0.08
0.055822785
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.017241379
0.072072072
0.072072072
0.072072072
0.072072072
0.071036036
0.01174569
0.046036036
0.046036036
0.046036036
0.046036036
0.04756689
0.00625
0.02
0.02
0.02
0.02
0.024097744
0.00625
0.02
0.02
0.02
0.02
0.024097744
0.00625
0.02
0.02
0.02
0.02
0.024097744

0.18713
0.21712
0
0.02222
0.03494
0.01553
0
0.02485
0.02343

0.18713
0.01996
0
0.02222
0.19058
0.01553
0
0.02485
0.02343];

%% icon_pfix
icon_pfix = [0.64
0.431141795
5.128282613
0
0
0.155782254
0.78
0.879653347
0
0
0.22482848
0.240879124
0.95
0.078907042
0
0.633810681
0.671814601
1.504012578
0.208317643
0.039844509
0.813119911
0.513617553
1.084411517
0.138927063
0.028709149
0.050147311
0.237395151
0.439412541
0.199015116
0.042588474
0
0.035896288
0.569523729
0.177352647
0.086700766
0
0
0
0.53
0.286327659
0
0
0
0.41521556
0.53

0.50031709
0.061912406
0.018180588
0.009355558
0.004275221
0.014934379
0.007462763
0
0.58825626
0.220171682
0.068294735
0.025941574
0.032103371
0.026594081
0.017751256
0
0.641668726
2.079256717
0.629918416
0.082946649
0.113253535
0.106403815
0.052325349
0
0.386709069
1.16340777
0.532191618
0.097874554
0.084245599
0.067393636
0.050955785
0
0.536793676
0.407364489
0.343070369
0.093255608
0.103019839
0.097034148
0.063815305
0
0.95
0.115969853
0.127212102
0.150558675
0.153272609
0.224990706
0.182542467
0
0.058034345
1.28083132
0.180579394
0.259532955
0.273583918
0.315802597
0
0
0
0.2114526
0.66
0.15591755
0.1263145
0.098519708
0.115421073
0
0.120263055
1.016363479
0.734472557
1.227609743
0.144183979
0.262615761
0.186203521
0
0.621554726
0.930442599
0.599078884
0.169003634
0.71
0.247470383
0.316731566
0
0.279417071
0.931829017
0.681363225
0.256568776
0.225130714
0.71
0.33859894
0
0.262617775
0.560790836
0.752457273
0.306264067
0.217942248
0.315034354
0.71
0
0.028648179
0.030872292
0.387497841
0.288105917
0.438720767
0.378383779
0.412702542
0.694966393
0
1.348858203
0.644273664
0.556555541
0.652138832
1.181165171
0.367086185
0
0
0.483411614
0.438579947
0.141620826
0.259773703
0.455713381
0.597466718
0
0
0.167212583
0.266181624
0.090944513
0.158915733
0.273964898
0.393425315
0

0.00043147
0.008839309
0.004609927
0.022025268
0.003200235
0.039875606
0.048383942
0.189479636
0.090818242
0.135564018
0.066827023
-0.009353329
0.881588977
1.138251181
0.851593171
0.306323589
0.131712952
0.10463046
1.928659093
1.009992849
0.568312555
0.152096801
0.109573508
-0.000311159
1.058163252
0.572888499
0.320341461
0.064397267
0.04609905
0.078999876
0.16192048
0.343884463
0.159546645
0.06078212
0.039635837
0.089216425
0.087262775
0.349915889
0.22005457
0.155887957
0.087950709
0.162065647
0.66
0.186503972
0.229136292
0.206302719
0.117492024
0.272290301
0.907178995
0.71
0.276416919
0.267363805
0.251704117
0.404174805
0.852137812
0.265352305
0.71
0.420434812
0.309677198
0.546053836
0.81395156
0.319503074
0.246915881
0.71
0.474342332
0.427799946
1.556684192
0.429577731
0.353887738
0.351959567
0.71
0.281052144
0.390909039
0.34156031
0.516022273
0.70210713
0.462587964
1.075772895
1.07780842
0.320857093
0.625169856
1.186457635
0.892401635
1.080536199
0.1527969
0.223097077
0.173920313
0.240466167
0.393571521
0.447204259
0.433812773
0.092116429
0.130478602
0.190395309
0.231051624
0.199891119

0.78
1.01
0
0.3525
0.1225
0.4375
0
0.24786
0.53];

%% weights
IT_23 = [0 0.05928	0.01883	0.02702	0.02729	0.00782	0.00048	-0.00066	0.00017	0.00153;
0 0.02356	0.14596	0.03501	0.01510	0.00923	0.00426	0.00064	0.00029	0.00070;
0 0.04931	0.02070	0.23069	0.01094	0.00792	0.00321	0.00416	0.00452	0.00163];

IT_CT_6 = [0 0.00238	-0.00062	0.00255	0.00659	0.00972	0.01393	0.01241	0.01494	0.01171
0 0.00211	0.00084	-0.00081	0.00126	0.00201	0.00298	0.00607	0.00807	0.01494];

IT_5 = [0.00481	0.00566	0.00617	0.00910	0.01263	0.23069	0.00726	0.00000	0.00088	0.00454	0.00204	0.00192	0.00244	0.00011	0.00000	0.00103;
0.00323	0.01149	0.10854	0.04712	0.01650	0.02080	0.17823	0.02092	0.01247	0.01142	0.01143	0.00688	0.00378	0.00422	0.00151	0.00052;
0.00172	0.00647	0.05971	0.03059	0.01972	0.01475	0.01490	0.12578	0.01266	0.01033	0.01175	0.01297	0.00455	0.00403	0.00274	0.00166;
0.00089	0.00246	0.00786	0.01194	0.01137	0.01218	0.01641	0.01247	0.05117	0.01218	0.01849	0.02207	0.01326	0.01113	0.00283	0.00182;
0.00036	0.00268	0.00944	0.01027	0.01256	0.01240	0.01730	0.01011	0.01039	0.05117	0.01623	0.01571	0.02020	0.01304	0.00520	0.00318;
0.00124	0.00222	0.00887	0.00822	0.01183	0.01820	0.01997	0.00788	0.01893	0.01784	0.05117	0.02271	0.01742	0.02362	0.00911	0.00548;
0.00062	0.00148	0.00436	0.00621	0.00778	0.01476	0.00000	0.00923	0.01342	0.02283	0.02440	0.05117	0.01900	0.00734	0.01195	0.00787;
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.0	0.00000	0.00000	0.00000];

PT_5 = [0.00004	0.00459	0.08356	0.11084	0.06081	0.01877	0.00720	0.12578	0.01564	0.01469	0.01403	0.02684	0.00459	0.00674	0.00095	0.00271;
0.00084	0.01796	0.10789	0.12317	0.06986	0.02781	0.02213	0.01492	0.05117	0.01912	0.02303	0.03096	0.01572	0.00642	0.00446	0.00184;
0.00038	0.00757	0.07097	0.06931	0.03907	0.01290	0.01392	0.01833	0.01992	0.05117	0.01780	0.02551	0.02376	0.01250	0.00348	0.00261;
0.00184	0.01130	0.02553	0.01855	0.00785	0.00492	0.00986	0.01650	0.01927	0.03030	0.05117	0.02537	0.03232	0.02373	0.00481	0.00381;
0.00027	0.00557	0.01098	0.01336	0.00562	0.00321	0.00556	0.00940	0.01814	0.02232	0.03419	0.05117	0.02130	0.01785	0.00787	0.00462;
0.00166	-0.00039	0.00436	-0.00002	0.00482	0.00505	0.00911	0.01520	0.02871	0.03879	0.03039	0.01996	0.05117	0.02604	0.01078	0.00482;];

fontSiz =16;
h1=figure;
imagesc(IT_23);
set(gca,'FontSize',fontSiz)
xlabel('Pre (NCD)');
ylabel('Post (NCD)');
set(gca,'XTick',[0.5:1:10.5]);
set(gca,'XTickLabel',[0:0.1:1]);
set(gca,'YTick',[0.5:1:4.5]);
set(gca,'YTickLabel',[0.1:0.1:0.4]);
set(gca,'XAxisLocation','top','YAxisLocation','left','ydir','reverse');
axis ij
caxis([0,0.25]);
colorbar;
set(h1,'PaperUnits','inches','PaperPosition',[0 0 10 3])
print(h1,'-dpng','-r300','fig_IT_23')

fontSiz =16;
h2=figure
imagesc(IT_CT_6);
set(gca,'FontSize',fontSiz)
xlabel('Pre (NCD)');
ylabel('Post (NCD)');
set(gca,'XTick',[0.5:1:10.5]);
set(gca,'XTickLabel',[0:0.1:1]);
set(gca,'YTick',[0.5:1:3.5]);
set(gca,'YTickLabel',[0.8:0.1:1.0]);
set(gca,'XAxisLocation','top','YAxisLocation','left','ydir','reverse');
axis ij
caxis([0,0.25]);
colorbar;
set(h2,'PaperUnits','inches','PaperPosition',[0 0 10 2.2])
print(h2,'-dpng','-r300','fig_IT_6')
                
fontSiz =16;
h3= figure;
imagesc(IT_5);
set(gca,'FontSize',fontSiz)
xlabel('Pre (NCD)');
ylabel('Post (NCD)');
set(gca,'XTick',[0.5:2:17.5]);
set(gca,'XTickLabel',[0:0.125:1]);
set(gca,'YTick',[1.5:2:9.5]);
set(gca,'YTickLabel',[0.375:0.125:0.9]);
set(gca,'XAxisLocation','top','YAxisLocation','left','ydir','reverse');
axis ij
caxis([0,0.25]);
colorbar;
set(h3,'PaperUnits','inches','PaperPosition',[0 0 10 4.5])
print(h3,'-dpng','-r300','fig_IT_5')

fontSiz =16;
h4=figure;
imagesc(PT_5);
set(gca,'FontSize',fontSiz)
xlabel('Pre (NCD)');
ylabel('Post (NCD)');
set(gca,'XTick',[0.5:2:17.5]);
set(gca,'XTickLabel',[0:0.125:1]);
set(gca,'YTick',[1.5:2:8.5]);
set(gca,'YTickLabel',[0.5:0.125:0.9]);
set(gca,'XAxisLocation','top','YAxisLocation','left','ydir','reverse');
axis ij
caxis([0,0.25]);
colorbar;
set(h4,'PaperUnits','inches','PaperPosition',[0 0 10 3.5])
print(h4,'-dpng','-r300','fig_PT_5')

    

%% hist
nbins=20;
h5=figure; 
subplot(2,1,1)
fontSiz =16;
hist(pcon_ifix,nbins);
set(gca,'FontSize',fontSiz)
%title('pcon_ifix');
xlabel('conn probability (p) (calculated as T/u)');
ylabel('num of conn rules');
box on;

subplot(2,1,2);
hist(icon_ifix,nbins);
set(gca,'FontSize',fontSiz)
xlabel('unitary conn strength (u) (based on Lefort)');
ylabel('num of conn rules');
box on;
set(h5,'PaperUnits','inches','PaperPosition',[0 0 6 7])
print(h5,'-dpng','-r300','u_fix')

h6=figure;
subplot(2,1,1)
hist(pcon_pfix,nbins);
set(gca,'FontSize',fontSiz)
xlabel('conn probability (p) (based on Lefort)');
ylabel('num of conn rules');
box on;

subplot(2,1,2);
hist(icon_pfix,nbins);
set(gca,'FontSize',fontSiz)
xlabel('unitary conn strength (u) (calculated as T/p)');
ylabel('num of conn rules');
xlim([0 6]);
box on;

set(h6,'PaperUnits','inches','PaperPosition',[0 0 6 7])
print(h6,'-dpng','-r300','p_fix')


